<!DOCTYPE html>
<html lang="th" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏û‡∏£‡∏µ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÄ‡∏™‡∏∑‡πâ‡∏≠ - DY ESAN SHOP</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            box-sizing: border-box;
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .hover-scale {
            transition: transform 0.3s ease;
        }
        .hover-scale:hover {
            transform: scale(1.05);
        }
        .glass-effect {
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.1);
        }
    </style>
</head>
<body class="h-full bg-gradient-to-br from-gray-900 via-black to-gray-800 font-sans text-white">
    <header class="bg-black/80 backdrop-blur-md shadow-2xl sticky top-0 z-50 border-b border-gray-700">
        <div class="max-w-6xl mx-auto px-4 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-2">
                    <div class="w-10 h-10 flex items-center justify-center">
                        <img src="https://img5.pic.in.th/file/secure-sv1/448205987_. _. 819_n-removebg-preview.png" alt="DY ESAN SHOP Logo" class="w-full h-full object-contain" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                        <div class="w-10 h-10 bg-gradient-to-r from-red-500 to-orange-500 rounded-full flex items-center justify-center" style="display: none;">
                            <span class="text-white font-bold text-lg">DY</span>
                        </div>
                    </div>
                    <h1 class="text-2xl font-bold text-white">DY ESAN SHOP</h1>
                </div>
                <nav class="hidden md:flex space-x-6">
                    <button onclick="showPage('home')" class="text-gray-300 hover:text-red-400 transition-colors">‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</button>
                    <button onclick="showPage('products')" class="text-gray-300 hover:text-red-400 transition-colors">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</button>
                    <button onclick="showPage('contact')" class="text-gray-300 hover:text-red-400 transition-colors">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</button>
                    <button onclick="showPage('admin')" class="text-gray-300 hover:text-red-400 transition-colors">üîß Admin</button>
                </nav>
            </div>
        </div>
    </header>

    <main class="max-w-6xl mx-auto px-4 py-8">
        <!-- Home Page -->
        <div id="homePage" class="page-content">
            <!-- Hero Section -->
            <section class="text-center mb-12 fade-in">
                <h2 class="text-4xl md:text-5xl font-bold text-white mb-4">
                    ‡∏û‡∏£‡∏µ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÄ‡∏™‡∏∑‡πâ‡∏≠
                </h2>
                <p class="text-xl text-gray-300 mb-8">‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏™‡∏π‡πà DY ESAN SHOP</p>
                <div class="flex justify-center">
                    <!-- View products button removed -->
                </div>
            </section>

            <!-- Featured Product Preview -->
            <section class="mb-12">
                <h3 class="text-2xl font-bold text-center text-white mb-6">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</h3>
                <div class="bg-gradient-to-r from-red-900/30 to-orange-900/30 border border-red-500/50 rounded-xl p-6 text-center">
                    <!-- Product Image Preview -->
                    <div class="w-full max-w-xs h-[400px] mx-auto mb-6 bg-gray-800 border-2 border-dashed border-gray-600 rounded-lg flex items-center justify-center" style="aspect-ratio: 1/1.5;">
                        <img src="https://img5.pic.in.th/file/secure-sv1/Black-and-White-Minimalist-T-Shirt-Instagram-Post-3.png" alt="NEW COLLECTION ESAN" class="w-full h-full object-cover rounded-lg" onerror="this.src=''; this.alt='Image failed to load'; this.nextElementSibling.style.display='flex';">
                        <div class="text-gray-400 text-center" style="display: none;">
                            <div class="text-4xl mb-2">üì∑</div>
                            <p class="text-sm">‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ</p>
                            <p class="text-xs">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö URL ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û</p>
                        </div>
                    </div>
                    
                    <h4 class="text-xl font-bold text-red-400 mb-2">NEW COLLECTION ESAN</h4>
                    <div class="text-2xl font-bold text-red-400 mb-4">‡∏ø259</div>
                    <!-- View details button removed -->
                </div>
            </section>
        </div>

        <!-- Products Page -->
        <div id="productsPage" class="page-content hidden">
            <section class="mb-8">
                <div class="flex items-center justify-between mb-8">
                    <h2 class="text-3xl font-bold text-white">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏û‡∏£‡∏µ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</h2>
                    <button onclick="showPage('home')" class="text-gray-400 hover:text-white transition-colors">
                        ‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
                    </button>
                </div>


                
                <!-- Product Section -->
                <div class="product-category">
                    
                    <!-- NEW COLLECTION ESAN -->
                    <div class="bg-gradient-to-r from-red-900/50 to-orange-900/50 border border-red-500 rounded-xl p-6 mb-8">
                        <!-- Product Image -->
                        <div class="text-center mb-6">
                            <div class="w-full max-w-md h-[600px] mx-auto mb-4 bg-gray-800 border-2 border-dashed border-gray-600 rounded-lg flex items-center justify-center" style="aspect-ratio: 600/1200;">
                                <!-- ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ NEW COLLECTION ESAN -->
                                <img src="https://img5.pic.in.th/file/secure-sv1/Black-and-White-Minimalist-T-Shirt-Instagram-Post-3.png" alt="NEW COLLECTION ESAN" class="w-full h-full object-cover rounded-lg" onerror="this.src=''; this.alt='Image failed to load'; this.nextElementSibling.style.display='flex';">
                                <div class="text-gray-400 text-center" style="display: none;">
                                    <div class="text-4xl mb-2">üì∑</div>
                                    <p class="text-sm">‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ</p>
                                    <p class="text-xs">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö URL ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="text-center mb-6">
                            <h4 class="text-2xl font-bold text-red-400 mb-2">NEW COLLECTION</h4>
                            <h5 class="text-4xl font-bold text-white mb-4">ESAN</h5>
                            <div class="text-3xl font-bold text-red-400 mb-4">‡∏ø259</div>
                            <p class="text-gray-300 mb-4">+ ‡∏Ñ‡πà‡∏≤‡∏à‡∏±‡∏î‡∏™‡πà‡∏á ‡∏ø49</p>
                        </div>
                        
                        <!-- Size Chart -->
                        <div class="bg-gray-900/80 rounded-lg p-4 mb-6">
                            <h6 class="text-lg font-bold text-white mb-3 text-center">‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÑ‡∏ã‡∏™‡πå</h6>
                            <div class="overflow-x-auto">
                                <table class="w-full text-sm text-white">
                                    <thead>
                                        <tr class="border-b border-gray-600">
                                            <th class="text-left py-2 px-2">SIZE</th>
                                            <th class="text-center py-2 px-2">S</th>
                                            <th class="text-center py-2 px-2">M</th>
                                            <th class="text-center py-2 px-2">L</th>
                                            <th class="text-center py-2 px-2">XL</th>
                                            <th class="text-center py-2 px-2">XXL</th>
                                            <th class="text-center py-2 px-2">3XL</th>
                                            <th class="text-center py-2 px-2">4XL</th>
                                            <th class="text-center py-2 px-2">5XL</th>
                                            <th class="text-center py-2 px-2">6XL</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr class="border-b border-gray-700">
                                            <td class="py-2 px-2 font-semibold">LENGTH</td>
                                            <td class="text-center py-2 px-2">26</td>
                                            <td class="text-center py-2 px-2">27</td>
                                            <td class="text-center py-2 px-2">28</td>
                                            <td class="text-center py-2 px-2">29</td>
                                            <td class="text-center py-2 px-2">30</td>
                                            <td class="text-center py-2 px-2">31</td>
                                            <td class="text-center py-2 px-2">32</td>
                                            <td class="text-center py-2 px-2">32</td>
                                            <td class="text-center py-2 px-2">34</td>
                                        </tr>
                                        <tr>
                                            <td class="py-2 px-2 font-semibold">WIDTH</td>
                                            <td class="text-center py-2 px-2">38</td>
                                            <td class="text-center py-2 px-2">40</td>
                                            <td class="text-center py-2 px-2">42</td>
                                            <td class="text-center py-2 px-2">44</td>
                                            <td class="text-center py-2 px-2">46</td>
                                            <td class="text-center py-2 px-2">48</td>
                                            <td class="text-center py-2 px-2">50</td>
                                            <td class="text-center py-2 px-2">52</td>
                                            <td class="text-center py-2 px-2">54</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        
                        <!-- Price Info -->
                        <div class="bg-gray-900/80 rounded-lg p-4 mb-6">
                            <h6 class="text-lg font-bold text-white mb-3 text-center">‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏≤‡∏°‡πÑ‡∏ã‡∏™‡πå</h6>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-center">
                                <div class="text-yellow-400">
                                    <span class="font-semibold">XXL:</span> +‡∏ø20
                                </div>
                                <div class="text-yellow-400">
                                    <span class="font-semibold">3XL:</span> +‡∏ø40
                                </div>
                                <div class="text-yellow-400">
                                    <span class="font-semibold">4XL, 5XL, 6XL:</span> +‡∏ø60
                                </div>
                            </div>
                        </div>
                        
                        <div class="text-center">
                            <button onclick="openPreorderModal('NEW COLLECTION ESAN', 259)" class="bg-gradient-to-r from-red-600 to-orange-600 text-white px-8 py-4 rounded-lg font-bold text-lg hover:from-red-700 hover:to-orange-700 transition-all">
                                ‡∏û‡∏£‡∏µ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå NEW COLLECTION ESAN
                            </button>
                        </div>
                    </div>



                </div>






            </section>
        </div>

        <!-- Admin Panel Page -->
        <div id="adminPage" class="page-content hidden">
            <!-- Admin Login Form -->
            <div id="adminLoginForm" class="max-w-md mx-auto">
                <div class="bg-gradient-to-r from-gray-900/80 to-black/80 border border-gray-600 rounded-xl p-8">
                    <div class="text-center mb-8">
                        <div class="w-16 h-16 bg-gradient-to-r from-red-600 to-orange-600 rounded-full flex items-center justify-center mx-auto mb-4">
                            <span class="text-3xl">üîê</span>
                        </div>
                        <h2 class="text-2xl font-bold text-white mb-2">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö Admin</h2>
                        <p class="text-gray-400">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</p>
                    </div>
                    
                    <form id="adminLoginFormElement" onsubmit="submitAdminLogin(event)" class="space-y-6">
                        <div>
                            <label for="adminUsername" class="block text-sm font-medium text-gray-300 mb-2">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô *</label>
                            <input type="text" id="adminUsername" name="adminUsername" required 
                                   class="w-full px-4 py-3 border border-gray-600 rounded-lg bg-gray-800 text-white focus:ring-2 focus:ring-red-500 focus:border-transparent"
                                   placeholder="‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô">
                        </div>
                        
                        <div>
                            <label for="adminPassword" class="block text-sm font-medium text-gray-300 mb-2">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô *</label>
                            <input type="password" id="adminPassword" name="adminPassword" required 
                                   class="w-full px-4 py-3 border border-gray-600 rounded-lg bg-gray-800 text-white focus:ring-2 focus:ring-red-500 focus:border-transparent"
                                   placeholder="‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô">
                        </div>
                        
                        <div id="loginError" class="hidden bg-red-900/50 border border-red-500 text-red-300 px-4 py-3 rounded-lg text-sm">
                            ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
                        </div>
                        
                        <button type="submit" class="w-full bg-gradient-to-r from-red-600 to-orange-600 text-white py-3 rounded-lg font-semibold hover:from-red-700 hover:to-orange-700 transition-all">
                            ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö
                        </button>
                        
                        <div class="text-center">
                            <button type="button" onclick="showPage('home')" class="text-gray-400 hover:text-white transition-colors text-sm">
                                ‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
                            </button>
                        </div>
                    </form>
                    

                </div>
            </div>

            <!-- Admin Dashboard (Hidden until login) -->
            <div id="adminDashboard" class="hidden">
                <section class="mb-8">
                    <div class="flex items-center justify-between mb-8">
                        <h2 class="text-3xl font-bold text-white">üîß Admin Panel</h2>
                        <div class="flex items-center space-x-4">
                            <span class="text-gray-400">‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö, <span id="adminWelcome" class="text-white font-semibold"></span></span>
                            <button onclick="logoutAdmin()" class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg text-sm transition-colors">
                                ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö
                            </button>
                        </div>
                    </div>
                
                <!-- Admin Dashboard Grid -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    
                    <!-- Users Management -->
                    <div class="bg-gradient-to-r from-blue-900/50 to-blue-800/50 border border-blue-500 rounded-xl p-6">
                        <div class="flex items-center mb-4">
                            <span class="text-3xl mr-3">üë•</span>
                            <h3 class="text-xl font-bold text-white">‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ (Users)</h3>
                        </div>
                        <div class="space-y-3">
                            <button onclick="showAdminSection('usersList')" class="w-full text-left bg-blue-800/50 hover:bg-blue-700/50 text-white px-4 py-2 rounded-lg transition-colors">
                                üìã ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
                            </button>
                            <button onclick="showAdminSection('createUser')" class="w-full text-left bg-blue-800/50 hover:bg-blue-700/50 text-white px-4 py-2 rounded-lg transition-colors">
                                ‚ûï ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÉ‡∏´‡∏°‡πà
                            </button>
                            <button onclick="showAdminSection('editUser')" class="w-full text-left bg-blue-800/50 hover:bg-blue-700/50 text-white px-4 py-2 rounded-lg transition-colors">
                                ‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
                            </button>
                            <button onclick="showAdminSection('userRoles')" class="w-full text-left bg-blue-800/50 hover:bg-blue-700/50 text-white px-4 py-2 rounded-lg transition-colors">
                                üîê ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó/‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå
                            </button>
                            <button onclick="showAdminSection('blockUser')" class="w-full text-left bg-blue-800/50 hover:bg-blue-700/50 text-white px-4 py-2 rounded-lg transition-colors">
                                üö´ ‡∏£‡∏∞‡∏á‡∏±‡∏ö/‡∏õ‡∏•‡∏î‡∏£‡∏∞‡∏á‡∏±‡∏ö
                            </button>
                        </div>
                    </div>



                    <!-- Orders & Payments -->
                    <div class="bg-gradient-to-r from-purple-900/50 to-purple-800/50 border border-purple-500 rounded-xl p-6">
                        <div class="flex items-center mb-4">
                            <span class="text-3xl mr-3">üí≥</span>
                            <h3 class="text-xl font-bold text-white">‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠/‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</h3>
                        </div>
                        <div class="space-y-3">
                            <button onclick="showAdminSection('ordersList')" class="w-full text-left bg-purple-800/50 hover:bg-purple-700/50 text-white px-4 py-2 rounded-lg transition-colors">
                                üì¶ ‡∏î‡∏π‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÅ‡∏•‡∏∞‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
                            </button>
                            <button onclick="showAdminSection('paymentSlips')" class="w-full text-left bg-purple-800/50 hover:bg-purple-700/50 text-white px-4 py-2 rounded-lg transition-colors">
                                üìÑ ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏•‡∏¥‡∏õ‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô
                            </button>
                            <button onclick="showAdminSection('invoices')" class="w-full text-left bg-purple-800/50 hover:bg-purple-700/50 text-white px-4 py-2 rounded-lg transition-colors">
                                üßæ ‡∏≠‡∏≠‡∏Å‡πÉ‡∏ö‡πÅ‡∏à‡πâ‡∏á‡∏´‡∏ô‡∏µ‡πâ/‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏á‡∏¥‡∏ô
                            </button>
                        </div>
                    </div>

                    <!-- Website Settings -->
                    <div class="bg-gradient-to-r from-orange-900/50 to-orange-800/50 border border-orange-500 rounded-xl p-6">
                        <div class="flex items-center mb-4">
                            <span class="text-3xl mr-3">‚öôÔ∏è</span>
                            <h3 class="text-xl font-bold text-white">‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå</h3>
                        </div>
                        <div class="space-y-3">
                            <button onclick="showAdminSection('generalSettings')" class="w-full text-left bg-orange-800/50 hover:bg-orange-700/50 text-white px-4 py-2 rounded-lg transition-colors">
                                üåê ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ
                            </button>
                            <button onclick="showAdminSection('apiSettings')" class="w-full text-left bg-orange-800/50 hover:bg-orange-700/50 text-white px-4 py-2 rounded-lg transition-colors">
                                üîë ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ SMTP/API
                            </button>
                        </div>
                    </div>





                    <!-- Reports -->
                    <div class="bg-gradient-to-r from-indigo-900/50 to-indigo-800/50 border border-indigo-500 rounded-xl p-6">
                        <div class="flex items-center mb-4">
                            <span class="text-3xl mr-3">üìà</span>
                            <h3 class="text-xl font-bold text-white">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô (Reports)</h3>
                        </div>
                        <div class="space-y-3">
                            <button onclick="showAdminSection('userReports')" class="w-full text-left bg-indigo-800/50 hover:bg-indigo-700/50 text-white px-4 py-2 rounded-lg transition-colors">
                                üë• ‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÉ‡∏´‡∏°‡πà
                            </button>
                            <button onclick="showAdminSection('salesReports')" class="w-full text-left bg-indigo-800/50 hover:bg-indigo-700/50 text-white px-4 py-2 rounded-lg transition-colors">
                                üí∞ ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢/‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ
                            </button>
                        </div>
                    </div>







                </div>

                <!-- Admin Section Content Area -->
                <div id="adminSectionContent" class="mt-8 hidden">
                    <div class="bg-gray-900/80 border border-gray-600 rounded-xl p-6">
                        <div class="flex items-center justify-between mb-6">
                            <h3 id="adminSectionTitle" class="text-2xl font-bold text-white"></h3>
                            <button onclick="closeAdminSection()" class="text-gray-400 hover:text-white text-2xl">&times;</button>
                        </div>
                        <div id="adminSectionBody" class="text-gray-300">
                            <!-- Dynamic content will be loaded here -->
                        </div>
                    </div>
                </div>

                </section>
            </div>
        </div>

        <!-- Contact Page -->
        <div id="contactPage" class="page-content hidden">
            <section class="mb-8">
                <div class="flex items-center justify-between mb-8">
                    <h2 class="text-3xl font-bold text-white">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏≤</h2>
                    <button onclick="showPage('home')" class="text-gray-400 hover:text-white transition-colors">
                        ‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
                    </button>
                </div>
                
                <div class="bg-gradient-to-r from-gray-900/50 to-black/50 border border-gray-600 rounded-xl p-8">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <!-- Contact Info -->
                        <div>
                            <h4 class="text-xl font-bold text-red-400 mb-6 text-center">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</h4>
                            <div class="space-y-4">
                                <div class="flex items-center space-x-3">
                                    <span class="text-2xl">üìò</span>
                                    <div>
                                        <p class="text-gray-300 text-sm">Facebook Page</p>
                                        <a href="https://www.facebook.com/profile.php?id=61566308819819" target="_blank" rel="noopener noreferrer" class="text-blue-400 font-semibold hover:text-blue-300 transition-colors">‡∏¢‡∏∏‡∏ß‡∏ä‡∏ô‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ò‡∏¥‡∏õ‡πÑ‡∏ï‡∏¢ ‡∏†‡∏≤‡∏Ñ‡∏ï‡∏∞‡∏ß‡∏±‡∏ô‡∏≠‡∏≠‡∏Å‡πÄ‡∏â‡∏µ‡∏¢‡∏á‡πÄ‡∏´‡∏ô‡∏∑‡∏≠</a>
                                    </div>
                                </div>
                                <div class="flex items-center space-x-3">
                                    <span class="text-2xl">üì±</span>
                                    <div>
                                        <p class="text-gray-300 text-sm">‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</p>
                                        <p class="text-white font-semibold">0621759759</p>
                                    </div>
                                </div>
                                <div class="flex items-center space-x-3">
                                    <span class="text-2xl">üìç</span>
                                    <div>
                                        <p class="text-gray-300 text-sm">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà</p>
                                        <p class="text-white font-semibold">‡∏Ç‡∏≠‡∏ô‡πÅ‡∏Å‡πà‡∏ô, ‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Contact Form -->
                        <div>
                            <h4 class="text-xl font-bold text-red-400 mb-6">‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏∂‡∏á‡πÄ‡∏£‡∏≤</h4>
                            <form id="contactForm" onsubmit="submitContact(event)" class="space-y-4">
                                <div>
                                    <label for="contactName" class="block text-sm font-medium text-gray-300 mb-2">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• *</label>
                                    <input type="text" id="contactName" name="contactName" required class="w-full px-3 py-2 border border-gray-600 rounded-lg bg-gray-800 text-white focus:ring-2 focus:ring-red-500 focus:border-transparent">
                                </div>
                                <div>
                                    <label for="contactEmail" class="block text-sm font-medium text-gray-300 mb-2">‡∏≠‡∏µ‡πÄ‡∏°‡∏• *</label>
                                    <input type="email" id="contactEmail" name="contactEmail" required class="w-full px-3 py-2 border border-gray-600 rounded-lg bg-gray-800 text-white focus:ring-2 focus:ring-red-500 focus:border-transparent">
                                </div>
                                <div>
                                    <label for="contactMessage" class="block text-sm font-medium text-gray-300 mb-2">‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° *</label>
                                    <textarea id="contactMessage" name="contactMessage" rows="4" required class="w-full px-3 py-2 border border-gray-600 rounded-lg bg-gray-800 text-white focus:ring-2 focus:ring-red-500 focus:border-transparent"></textarea>
                                </div>
                                <button type="submit" class="w-full bg-gradient-to-r from-red-600 to-orange-600 text-white py-3 rounded-lg font-semibold hover:from-red-700 hover:to-orange-700 transition-all">
                                    ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            </section>
        </div>

    </main>

    <!-- Contact Success Modal -->
    <div id="contactSuccessModal" class="fixed inset-0 bg-black bg-opacity-70 hidden items-center justify-center z-50 p-4">
        <div class="bg-gray-900 border border-gray-700 rounded-xl max-w-md w-full p-6 text-center fade-in">
            <div class="w-16 h-16 bg-green-900/50 rounded-full flex items-center justify-center mx-auto mb-4">
                <span class="text-3xl">‚úÖ</span>
            </div>
            <h3 class="text-2xl font-bold text-white mb-4">‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</h3>
            <p class="text-gray-300 mb-6">‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏Å‡∏•‡∏±‡∏ö‡πÇ‡∏î‡∏¢‡πÄ‡∏£‡πá‡∏ß‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</p>
            <button onclick="closeContactSuccessModal()" class="bg-gradient-to-r from-red-600 to-orange-600 text-white px-6 py-2 rounded-lg font-semibold hover:from-red-700 hover:to-orange-700 transition-all">
                ‡∏õ‡∏¥‡∏î
            </button>
        </div>
    </div>

    <!-- Preorder Modal -->
    <div id="preorderModal" class="fixed inset-0 bg-black bg-opacity-70 hidden items-center justify-center z-50 p-4">
        <div class="bg-gray-900 border border-gray-700 rounded-xl max-w-md w-full max-h-[90vh] overflow-y-auto p-6 fade-in">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold text-white">‡∏û‡∏£‡∏µ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</h3>
                <button onclick="closePreorderModal()" class="text-gray-400 hover:text-white text-2xl">&times;</button>
            </div>
            
            <form id="preorderForm" onsubmit="submitPreorder(event)">
                <div class="mb-4">
                    <label for="productName" class="block text-sm font-medium text-gray-300 mb-2">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</label>
                    <input type="text" id="productName" name="productName" readonly class="w-full px-3 py-2 border border-gray-600 rounded-lg bg-gray-800 text-white">
                </div>
                
                <div class="mb-4">
                    <label for="customerName" class="block text-sm font-medium text-gray-300 mb-2">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• *</label>
                    <input type="text" id="customerName" name="customerName" required class="w-full px-3 py-2 border border-gray-600 rounded-lg bg-gray-800 text-white focus:ring-2 focus:ring-red-500 focus:border-transparent">
                </div>
                
                <div class="mb-4">
                    <label for="phone" class="block text-sm font-medium text-gray-300 mb-2">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå *</label>
                    <input type="tel" id="phone" name="phone" required class="w-full px-3 py-2 border border-gray-600 rounded-lg bg-gray-800 text-white focus:ring-2 focus:ring-red-500 focus:border-transparent">
                </div>
                
                <div class="mb-4">
                    <label for="size" class="block text-sm font-medium text-gray-300 mb-2">‡πÑ‡∏ã‡∏™‡πå *</label>
                    <select id="size" name="size" required class="w-full px-3 py-2 border border-gray-600 rounded-lg bg-gray-800 text-white focus:ring-2 focus:ring-red-500 focus:border-transparent" onchange="updateTotalPrice()">
                        <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ã‡∏™‡πå</option>
                        <option value="S">S</option>
                        <option value="M">M</option>
                        <option value="L">L</option>
                        <option value="XL">XL</option>
                        <option value="XXL">XXL (+‡∏ø20)</option>
                        <option value="3XL">3XL (+‡∏ø40)</option>
                        <option value="4XL">4XL (+‡∏ø60)</option>
                        <option value="5XL">5XL (+‡∏ø60)</option>
                        <option value="6XL">6XL (+‡∏ø60)</option>
                    </select>
                </div>
                
                <div class="mb-4">
                    <label for="quantity" class="block text-sm font-medium text-gray-300 mb-2">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô *</label>
                    <input type="number" id="quantity" name="quantity" min="1" value="1" required class="w-full px-3 py-2 border border-gray-600 rounded-lg bg-gray-800 text-white focus:ring-2 focus:ring-red-500 focus:border-transparent" oninput="updateTotalPrice()">
                </div>
                
                <div class="mb-6">
                    <label for="address" class="block text-sm font-medium text-gray-300 mb-2">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏±‡∏î‡∏™‡πà‡∏á *</label>
                    <textarea id="address" name="address" rows="3" required class="w-full px-3 py-2 border border-gray-600 rounded-lg bg-gray-800 text-white focus:ring-2 focus:ring-red-500 focus:border-transparent"></textarea>
                </div>
                
                <!-- Bank Account Info -->
                <div class="mb-6 p-4 bg-blue-900/30 border border-blue-500 rounded-lg">
                    <h6 class="text-lg font-bold text-blue-400 mb-3 text-center">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</h6>
                    <div class="space-y-2 text-sm text-gray-300">
                        <div class="flex justify-between">
                            <span class="font-semibold">‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£:</span>
                            <span>‡∏Å‡∏£‡∏∏‡∏á‡πÑ‡∏ó‡∏¢</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="font-semibold">‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ç‡∏ä‡∏µ:</span>
                            <span>‡∏¢‡∏∏‡∏ß‡∏ä‡∏ô‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ò‡∏¥‡∏õ‡πÑ‡∏ï‡∏¢ ‡∏†‡∏≤‡∏Ñ‡∏≠‡∏µ‡∏™‡∏≤‡∏ô</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="font-semibold">‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ç‡∏ä‡∏µ:</span>
                            <div class="flex items-center space-x-2">
                                <span class="font-mono text-blue-400" id="accountNumber">123-456-7890</span>
                                <button type="button" onclick="copyAccountNumber()" class="text-xs bg-blue-600 hover:bg-blue-700 text-white px-2 py-1 rounded transition-colors">
                                    üìã ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="mb-4">
                    <label for="paymentSlip" class="block text-sm font-medium text-gray-300 mb-2">‡πÅ‡∏ô‡∏ö‡∏™‡∏•‡∏¥‡∏õ‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô *</label>
                    <input type="file" id="paymentSlip" name="paymentSlip" accept="image/*" required class="w-full px-3 py-2 border border-gray-600 rounded-lg bg-gray-800 text-white focus:ring-2 focus:ring-red-500 focus:border-transparent file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-red-600 file:text-white hover:file:bg-red-700">
                    <p class="text-xs text-gray-400 mt-1">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÅ‡∏ô‡∏ö‡∏™‡∏•‡∏¥‡∏õ‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡∏≤‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á</p>
                </div>
                
                <div class="mb-6 p-4 bg-gray-800 border border-gray-600 rounded-lg">
                    <div class="mb-2">
                        <span id="priceBreakdown" class="text-sm text-gray-400">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ã‡∏™‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="font-semibold text-gray-300">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ß‡∏°:</span>
                        <span id="totalPrice" class="text-2xl font-bold text-red-400">‡∏ø0</span>
                    </div>
                </div>
                
                <button type="submit" class="w-full bg-gradient-to-r from-red-600 to-orange-600 text-white py-3 rounded-lg font-semibold hover:from-red-700 hover:to-orange-700 transition-all">
                    ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏û‡∏£‡∏µ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå
                </button>
            </form>
        </div>
    </div>

    <!-- Success Modal -->
    <div id="successModal" class="fixed inset-0 bg-black bg-opacity-70 hidden items-center justify-center z-50 p-4">
        <div class="bg-gray-900 border border-gray-700 rounded-xl max-w-md w-full p-6 text-center fade-in">
            <div class="w-16 h-16 bg-green-900/50 rounded-full flex items-center justify-center mx-auto mb-4">
                <span class="text-3xl">‚úÖ</span>
            </div>
            <h3 class="text-2xl font-bold text-white mb-4">‡∏û‡∏£‡∏µ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</h3>
            <div class="text-gray-300 mb-6 space-y-3">
                <p>‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏Å‡∏•‡∏±‡∏ö‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 24 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á</p>
                <div class="bg-blue-900/30 border border-blue-500 rounded-lg p-4">
                    <div class="flex items-center mb-2">
                        <span class="text-2xl mr-2">‚òÅÔ∏è</span>
                        <span class="font-semibold text-blue-400">‡∏™‡∏•‡∏¥‡∏õ‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</span>
                    </div>
                    <p class="text-sm text-gray-300">‡∏™‡∏•‡∏¥‡∏õ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏ñ‡∏π‡∏Å‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏õ‡∏¢‡∏±‡∏á Google Drive ‡πÅ‡∏•‡πâ‡∏ß</p>
                    <a href="https://drive.google.com/drive/u/0/folders/147ix5n16Zx6cfJ9ColbvwnYjk-9xhvvE" 
                       target="_blank" rel="noopener noreferrer" 
                       class="inline-flex items-center mt-2 text-blue-400 hover:text-blue-300 text-sm">
                        üìÅ ‡∏î‡∏π‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô Google Drive
                    </a>
                </div>
            </div>
            <button onclick="closeSuccessModal()" class="bg-gradient-to-r from-red-600 to-orange-600 text-white px-6 py-2 rounded-lg font-semibold hover:from-red-700 hover:to-orange-700 transition-all">
                ‡∏õ‡∏¥‡∏î
            </button>
        </div>
    </div>

    <footer class="bg-black border-t border-gray-700 text-white py-8 mt-12">
        <div class="max-w-6xl mx-auto px-4 text-center">
            <div class="flex items-center justify-center space-x-2 mb-4">
                <div class="w-8 h-8 flex items-center justify-center">
                    <img src="https://img5.pic.in.th/file/secure-sv1/448205987_. _. 819_n-removebg-preview.png" alt="DY ESAN SHOP Logo" class="w-full h-full object-contain" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                    <div class="w-8 h-8 bg-gradient-to-r from-red-500 to-orange-500 rounded-full flex items-center justify-center" style="display: none;">
                        <span class="text-white font-bold">DY</span>
                    </div>
                </div>
                <span class="text-xl font-bold">DY ESAN SHOP</span>
            </div>
            <div class="flex justify-center space-x-6">
                <span>üì± 0621759759</span>
                <span>üìç ‡∏Ç‡∏≠‡∏ô‡πÅ‡∏Å‡πà‡∏ô</span>
            </div>
        </div>
    </footer>

    <script>
        let currentPrice = 0;

        function openPreorderModal(productName, price) {
            currentPrice = price;
            document.getElementById('productName').value = productName;
            document.getElementById('quantity').value = 1;
            updateTotalPrice();
            document.getElementById('preorderModal').classList.remove('hidden');
            document.getElementById('preorderModal').classList.add('flex');
        }

        function closePreorderModal() {
            document.getElementById('preorderModal').classList.add('hidden');
            document.getElementById('preorderModal').classList.remove('flex');
            document.getElementById('preorderForm').reset();
        }

        function closeSuccessModal() {
            document.getElementById('successModal').classList.add('hidden');
            document.getElementById('successModal').classList.remove('flex');
        }

        function closeContactSuccessModal() {
            document.getElementById('contactSuccessModal').classList.add('hidden');
            document.getElementById('contactSuccessModal').classList.remove('flex');
        }

        function submitContact(event) {
            event.preventDefault();
            
            // Show loading state
            const submitBtn = event.target.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            submitBtn.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°...';
            submitBtn.disabled = true;
            
            // Simulate form submission
            setTimeout(() => {
                // Reset button
                submitBtn.textContent = originalText;
                submitBtn.disabled = false;
                
                // Reset form and show success modal
                document.getElementById('contactForm').reset();
                document.getElementById('contactSuccessModal').classList.remove('hidden');
                document.getElementById('contactSuccessModal').classList.add('flex');
            }, 2000);
        }

        function updateTotalPrice() {
            const quantity = parseInt(document.getElementById('quantity').value) || 1;
            const size = document.getElementById('size').value;
            
            let sizePrice = 0;
            if (size === 'XXL') sizePrice = 20;
            else if (size === '3XL') sizePrice = 40;
            else if (['4XL', '5XL', '6XL'].includes(size)) sizePrice = 60;
            
            const shipping = 49;
            const itemTotal = (currentPrice + sizePrice) * quantity;
            const total = itemTotal + shipping;
            
            document.getElementById('totalPrice').textContent = `‡∏ø${total.toLocaleString()}`;
            
            // Show price breakdown
            const breakdown = document.getElementById('priceBreakdown');
            if (breakdown) {
                let breakdownText = `‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤: ‡∏ø${(currentPrice * quantity).toLocaleString()}`;
                if (sizePrice > 0) {
                    breakdownText += ` + ‡∏Ñ‡πà‡∏≤‡πÑ‡∏ã‡∏™‡πå: ‡∏ø${(sizePrice * quantity).toLocaleString()}`;
                }
                breakdownText += ` + ‡∏Ñ‡πà‡∏≤‡∏à‡∏±‡∏î‡∏™‡πà‡∏á: ‡∏ø${shipping}`;
                breakdown.textContent = breakdownText;
            }
        }

        function submitPreorder(event) {
            event.preventDefault();
            
            // Show loading state
            const submitBtn = event.target.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            submitBtn.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏•‡∏¥‡∏õ...';
            submitBtn.disabled = true;
            
            // Get form data
            const formData = new FormData(event.target);
            const paymentSlipFile = formData.get('paymentSlip');
            
            // Validate file
            if (!paymentSlipFile || paymentSlipFile.size === 0) {
                // Reset button
                submitBtn.textContent = originalText;
                submitBtn.disabled = false;
                
                // Show error message
                showErrorMessage('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÅ‡∏ô‡∏ö‡∏™‡∏•‡∏¥‡∏õ‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô');
                return;
            }
            
            // Validate file type
            const allowedTypes = ['image/jpeg', 'image/jpg', 'image/png', 'image/gif'];
            if (!allowedTypes.includes(paymentSlipFile.type)) {
                // Reset button
                submitBtn.textContent = originalText;
                submitBtn.disabled = false;
                
                // Show error message
                showErrorMessage('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÅ‡∏ô‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô (JPG, PNG, GIF)');
                return;
            }
            
            // Validate file size (max 5MB)
            if (paymentSlipFile.size > 5 * 1024 * 1024) {
                // Reset button
                submitBtn.textContent = originalText;
                submitBtn.disabled = false;
                
                // Show error message
                showErrorMessage('‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 5MB');
                return;
            }
            
            // Get order details for sales tracking
            const quantity = parseInt(document.getElementById('quantity').value) || 1;
            const size = document.getElementById('size').value;
            
            let sizePrice = 0;
            if (size === 'XXL') sizePrice = 20;
            else if (size === '3XL') sizePrice = 40;
            else if (['4XL', '5XL', '6XL'].includes(size)) sizePrice = 60;
            
            const shipping = 49;
            const itemTotal = (currentPrice + sizePrice) * quantity;
            const total = itemTotal + shipping;
            
            // Process file upload
            processFileUpload(paymentSlipFile).then((uploadResult) => {
                const orderData = {
                    customerName: formData.get('customerName'),
                    phone: formData.get('phone'),
                    product: formData.get('productName'),
                    size: formData.get('size'),
                    quantity: quantity,
                    total: total,
                    address: formData.get('address'),
                    paymentSlip: uploadResult.url,
                    paymentSlipName: uploadResult.fileName,
                    paymentSlipData: uploadResult.dataUrl // Store base64 data for display
                };
                
                // Add order to system
                addOrder(orderData);
                
                // Reset button
                submitBtn.textContent = originalText;
                submitBtn.disabled = false;
                
                // Close preorder modal and show success modal
                closePreorderModal();
                document.getElementById('successModal').classList.remove('hidden');
                document.getElementById('successModal').classList.add('flex');
                
            }).catch((error) => {
                // Reset button
                submitBtn.textContent = originalText;
                submitBtn.disabled = false;
                
                // Show error message
                showErrorMessage('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏•‡∏¥‡∏õ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á');
                console.error('Upload error:', error);
            });
        }
        
        function processFileUpload(file) {
            return new Promise((resolve, reject) => {
                try {
                    // Generate unique filename with timestamp
                    const timestamp = new Date().toISOString().replace(/[:.]/g, '-');
                    const fileName = `slip_${timestamp}_${file.name}`;
                    
                    // Create FileReader to convert file to base64
                    const reader = new FileReader();
                    
                    reader.onload = function(e) {
                        // Upload to Google Drive using Apps Script Web App
                        uploadToGoogleDrive(file, fileName, e.target.result)
                            .then(uploadResult => {
                                resolve(uploadResult);
                            })
                            .catch(error => {
                                console.error('Google Drive upload failed:', error);
                                // Fallback to local storage
                                const uploadResult = {
                                    url: 'https://drive.google.com/drive/folders/147ix5n16Zx6cfJ9ColbvwnYjk-9xhvvE?usp=sharing',
                                    fileName: fileName,
                                    dataUrl: e.target.result,
                                    uploadTime: new Date().toISOString(),
                                    fileSize: file.size,
                                    fileType: file.type,
                                    status: 'local_backup'
                                };
                                
                                // Store in localStorage as backup
                                const uploadedFiles = JSON.parse(localStorage.getItem('uploadedSlips') || '[]');
                                uploadedFiles.push(uploadResult);
                                localStorage.setItem('uploadedSlips', JSON.stringify(uploadedFiles));
                                
                                resolve(uploadResult);
                            });
                    };
                    
                    reader.onerror = function() {
                        reject(new Error('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏î‡πâ'));
                    };
                    
                    // Start reading file
                    reader.readAsDataURL(file);
                    
                } catch (error) {
                    reject(error);
                }
            });
        }
        
        function uploadToGoogleDrive(file, fileName, base64Data) {
            return new Promise((resolve, reject) => {
                // Google Apps Script Web App URL (you need to deploy this)
                const GOOGLE_APPS_SCRIPT_URL = 'https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec';
                const FOLDER_ID = '147ix5n16Zx6cfJ9ColbvwnYjk-9xhvvE';
                
                // Prepare form data
                const formData = new FormData();
                formData.append('file', file);
                formData.append('fileName', fileName);
                formData.append('folderId', FOLDER_ID);
                
                let progress = 0;
                const uploadInterval = setInterval(() => {
                    progress += 10;
                    
                    // Update button text with progress
                    const submitBtn = document.querySelector('#preorderForm button[type="submit"]');
                    if (submitBtn) {
                        submitBtn.textContent = `‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏õ Google Drive... ${progress}%`;
                    }
                    
                    if (progress >= 90) {
                        clearInterval(uploadInterval);
                    }
                }, 150);
                
                // For demo purposes, simulate successful upload after progress completes
                setTimeout(() => {
                    clearInterval(uploadInterval);
                    
                    // Update final progress
                    const submitBtn = document.querySelector('#preorderForm button[type="submit"]');
                    if (submitBtn) {
                        submitBtn.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏õ Google Drive... 100%';
                    }
                    
                    // Simulate successful upload result
                    const uploadResult = {
                        url: `https://drive.google.com/drive/u/0/folders/${FOLDER_ID}`,
                        fileName: fileName,
                        dataUrl: base64Data,
                        uploadTime: new Date().toISOString(),
                        fileSize: file.size,
                        fileType: file.type,
                        folderId: FOLDER_ID,
                        status: 'uploaded_to_drive'
                    };
                    
                    // Store in localStorage for admin access
                    const uploadedFiles = JSON.parse(localStorage.getItem('uploadedSlips') || '[]');
                    uploadedFiles.push(uploadResult);
                    localStorage.setItem('uploadedSlips', JSON.stringify(uploadedFiles));
                    
                    resolve(uploadResult);
                    
                }, 2000);
                
                /* 
                // Real implementation would use fetch to upload to Google Apps Script
                fetch(GOOGLE_APPS_SCRIPT_URL, {
                    method: 'POST',
                    body: formData
                })
                .then(response => response.json())
                .then(result => {
                    clearInterval(uploadInterval);
                    
                    if (result.success) {
                        const uploadResult = {
                            url: result.fileUrl,
                            fileName: fileName,
                            dataUrl: base64Data,
                            uploadTime: new Date().toISOString(),
                            fileSize: file.size,
                            fileType: file.type,
                            folderId: FOLDER_ID,
                            driveFileId: result.fileId,
                            status: 'uploaded_to_drive'
                        };
                        
                        // Store in localStorage for admin access
                        const uploadedFiles = JSON.parse(localStorage.getItem('uploadedSlips') || '[]');
                        uploadedFiles.push(uploadResult);
                        localStorage.setItem('uploadedSlips', JSON.stringify(uploadedFiles));
                        
                        resolve(uploadResult);
                    } else {
                        reject(new Error(result.error || 'Upload failed'));
                    }
                })
                .catch(error => {
                    clearInterval(uploadInterval);
                    reject(error);
                });
                */
            });
        }
        
        function showErrorMessage(message) {
            // Create error modal
            const errorModal = document.createElement('div');
            errorModal.className = 'fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 p-4';
            errorModal.innerHTML = `
                <div class="bg-gray-900 border border-red-500 rounded-xl max-w-md w-full p-6 text-center fade-in">
                    <div class="w-16 h-16 bg-red-900/50 rounded-full flex items-center justify-center mx-auto mb-4">
                        <span class="text-3xl">‚ùå</span>
                    </div>
                    <h3 class="text-xl font-bold text-red-400 mb-4">‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î</h3>
                    <p class="text-gray-300 mb-6">${message}</p>
                    <button onclick="this.closest('.fixed').remove()" class="bg-red-600 hover:bg-red-700 text-white px-6 py-2 rounded-lg">
                        ‡∏õ‡∏¥‡∏î
                    </button>
                </div>
            `;
            document.body.appendChild(errorModal);
            
            // Auto remove after 5 seconds
            setTimeout(() => {
                if (errorModal.parentNode) {
                    errorModal.remove();
                }
            }, 5000);
        }

        function copyAccountNumber() {
            const accountNumber = document.getElementById('accountNumber').textContent;
            navigator.clipboard.writeText(accountNumber).then(function() {
                // Show success feedback
                const button = event.target;
                const originalText = button.textContent;
                button.textContent = '‚úÖ ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß';
                button.classList.add('bg-green-600');
                button.classList.remove('bg-blue-600');
                
                setTimeout(function() {
                    button.textContent = originalText;
                    button.classList.remove('bg-green-600');
                    button.classList.add('bg-blue-600');
                }, 2000);
            }).catch(function(err) {
                console.error('Could not copy text: ', err);
                // Fallback for older browsers
                const textArea = document.createElement('textarea');
                textArea.value = accountNumber;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                
                // Show success feedback
                const button = event.target;
                const originalText = button.textContent;
                button.textContent = '‚úÖ ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß';
                setTimeout(function() {
                    button.textContent = originalText;
                }, 2000);
            });
        }

        // Category filter system
        function filterProducts(category) {
            // Update active button
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.remove('active', 'bg-gradient-to-r', 'from-red-600', 'to-orange-600');
                btn.classList.add('bg-gray-700');
            });
            
            // Set active button
            event.target.classList.add('active', 'bg-gradient-to-r', 'from-red-600', 'to-orange-600');
            event.target.classList.remove('bg-gray-700');
            
            // Show/hide categories
            const categories = document.querySelectorAll('.product-category');
            
            if (category === 'all') {
                categories.forEach(cat => {
                    cat.classList.remove('hidden');
                });
            } else {
                categories.forEach(cat => {
                    if (cat.dataset.category === category) {
                        cat.classList.remove('hidden');
                    } else {
                        cat.classList.add('hidden');
                    }
                });
            }
        }

        // Page navigation system
        function showPage(pageName) {
            // Hide all pages
            document.querySelectorAll('.page-content').forEach(page => {
                page.classList.add('hidden');
            });
            
            // Show selected page
            const targetPage = document.getElementById(pageName + 'Page');
            if (targetPage) {
                targetPage.classList.remove('hidden');
                targetPage.classList.add('fade-in');
                
                // Special handling for admin page
                if (pageName === 'admin') {
                    // Always show login form first and hide dashboard
                    document.getElementById('adminLoginForm').classList.remove('hidden');
                    document.getElementById('adminDashboard').classList.add('hidden');
                    
                    // Reset admin login state
                    isAdminLoggedIn = false;
                    currentAdminUser = '';
                    
                    // Reset login form
                    document.getElementById('adminLoginFormElement').reset();
                    document.getElementById('loginError').classList.add('hidden');
                    
                    // Close any open admin sections
                    closeAdminSection();
                }
                
                // Scroll to top
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        // Admin Login Functions
        let isAdminLoggedIn = false;
        let currentAdminUser = '';

        function submitAdminLogin(event) {
            event.preventDefault();
            
            const username = document.getElementById('adminUsername').value;
            const password = document.getElementById('adminPassword').value;
            const errorDiv = document.getElementById('loginError');
            const submitBtn = event.target.querySelector('button[type="submit"]');
            
            // Show loading state
            const originalText = submitBtn.textContent;
            submitBtn.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö...';
            submitBtn.disabled = true;
            
            // Hide previous error
            errorDiv.classList.add('hidden');
            
            // Simulate login check (in real app, this would be server-side)
            setTimeout(() => {
                // Demo credentials: admin/admin123
                if (username === 'admin' && password === 'admin123') {
                    // Login successful
                    isAdminLoggedIn = true;
                    currentAdminUser = username;
                    
                    // Show admin dashboard
                    document.getElementById('adminLoginForm').classList.add('hidden');
                    document.getElementById('adminDashboard').classList.remove('hidden');
                    document.getElementById('adminWelcome').textContent = username;
                    
                    // Reset form
                    document.getElementById('adminLoginFormElement').reset();
                } else {
                    // Login failed
                    errorDiv.classList.remove('hidden');
                    
                    // Clear password field
                    document.getElementById('adminPassword').value = '';
                    document.getElementById('adminPassword').focus();
                }
                
                // Reset button
                submitBtn.textContent = originalText;
                submitBtn.disabled = false;
            }, 1500);
        }

        function logoutAdmin() {
            isAdminLoggedIn = false;
            currentAdminUser = '';
            
            // Stop real-time updates
            stopRealTimeUpdates();
            
            // Hide admin dashboard and show login form
            document.getElementById('adminDashboard').classList.add('hidden');
            document.getElementById('adminLoginForm').classList.remove('hidden');
            
            // Close any open admin sections
            closeAdminSection();
            
            // Reset login form
            document.getElementById('adminLoginFormElement').reset();
            document.getElementById('loginError').classList.add('hidden');
        }

        // Admin Panel Functions
        // Real-time update system
        let salesUpdateInterval;
        
        function startRealTimeUpdates() {
            // Clear existing interval if any
            if (salesUpdateInterval) {
                clearInterval(salesUpdateInterval);
            }
            
            // Update every 5 seconds when sales report is open
            salesUpdateInterval = setInterval(() => {
                if (document.getElementById('dailySales')) {
                    calculateSalesFromOrders();
                    updateOrdersList();
                }
            }, 5000);
        }
        
        function stopRealTimeUpdates() {
            if (salesUpdateInterval) {
                clearInterval(salesUpdateInterval);
                salesUpdateInterval = null;
            }
        }

        function showAdminSection(sectionType) {
            const contentArea = document.getElementById('adminSectionContent');
            const titleElement = document.getElementById('adminSectionTitle');
            const bodyElement = document.getElementById('adminSectionBody');
            
            // Show content area
            contentArea.classList.remove('hidden');
            contentArea.classList.add('fade-in');
            
            // Start real-time updates for sales reports
            if (sectionType === 'salesReports') {
                startRealTimeUpdates();
            } else {
                stopRealTimeUpdates();
            }
            
            // Set title and content based on section type
            const sections = {
                'usersList': {
                    title: 'üë• ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ',
                    content: `
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm">
                                <thead>
                                    <tr class="border-b border-gray-600">
                                        <th class="text-left py-3 px-4">ID</th>
                                        <th class="text-left py-3 px-4">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</th>
                                        <th class="text-left py-3 px-4">‡∏≠‡∏µ‡πÄ‡∏°‡∏•</th>
                                        <th class="text-left py-3 px-4">‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó</th>
                                        <th class="text-left py-3 px-4">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                                        <th class="text-left py-3 px-4">‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="border-b border-gray-700">
                                        <td class="py-3 px-4">001</td>
                                        <td class="py-3 px-4">admin</td>
                                        <td class="py-3 px-4">admin@dyesan.com</td>
                                        <td class="py-3 px-4"><span class="bg-red-600 px-2 py-1 rounded text-xs">Admin</span></td>
                                        <td class="py-3 px-4"><span class="bg-green-600 px-2 py-1 rounded text-xs">Active</span></td>
                                        <td class="py-3 px-4">
                                            <button class="bg-blue-600 hover:bg-blue-700 px-2 py-1 rounded text-xs mr-1">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
                                            <button class="bg-red-600 hover:bg-red-700 px-2 py-1 rounded text-xs">‡∏£‡∏∞‡∏á‡∏±‡∏ö</button>
                                        </td>
                                    </tr>
                                    <tr class="border-b border-gray-700">
                                        <td class="py-3 px-4">002</td>
                                        <td class="py-3 px-4">customer1</td>
                                        <td class="py-3 px-4">customer@example.com</td>
                                        <td class="py-3 px-4"><span class="bg-blue-600 px-2 py-1 rounded text-xs">Customer</span></td>
                                        <td class="py-3 px-4"><span class="bg-green-600 px-2 py-1 rounded text-xs">Active</span></td>
                                        <td class="py-3 px-4">
                                            <button class="bg-blue-600 hover:bg-blue-700 px-2 py-1 rounded text-xs mr-1">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
                                            <button class="bg-red-600 hover:bg-red-700 px-2 py-1 rounded text-xs">‡∏£‡∏∞‡∏á‡∏±‡∏ö</button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    `
                },
                'createUser': {
                    title: '‚ûï ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÉ‡∏´‡∏°‡πà',
                    content: `
                        <form class="space-y-4">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium mb-2">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ *</label>
                                    <input type="text" class="w-full px-3 py-2 border border-gray-600 rounded-lg bg-gray-800 text-white">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium mb-2">‡∏≠‡∏µ‡πÄ‡∏°‡∏• *</label>
                                    <input type="email" class="w-full px-3 py-2 border border-gray-600 rounded-lg bg-gray-800 text-white">
                                </div>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium mb-2">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô *</label>
                                    <input type="password" class="w-full px-3 py-2 border border-gray-600 rounded-lg bg-gray-800 text-white">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium mb-2">‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó *</label>
                                    <select class="w-full px-3 py-2 border border-gray-600 rounded-lg bg-gray-800 text-white">
                                        <option value="customer">Customer</option>
                                        <option value="admin">Admin</option>
                                        <option value="moderator">Moderator</option>
                                    </select>
                                </div>
                            </div>
                            <button type="submit" class="bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg">
                                ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
                            </button>
                        </form>
                    `
                },
                'ordersList': {
                    title: 'üì¶ ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå',
                    content: `
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm">
                                <thead>
                                    <tr class="border-b border-gray-600">
                                        <th class="text-left py-3 px-4">Order ID</th>
                                        <th class="text-left py-3 px-4">‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</th>
                                        <th class="text-left py-3 px-4">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</th>
                                        <th class="text-left py-3 px-4">‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°</th>
                                        <th class="text-left py-3 px-4">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                                        <th class="text-left py-3 px-4">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                                        <th class="text-left py-3 px-4">‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                                    </tr>
                                </thead>
                                <tbody id="ordersTableBody">
                                    ${ordersData.length === 0 ? `
                                        <tr>
                                            <td colspan="7" class="py-8 px-4 text-center text-gray-400">
                                                ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö<br>
                                                <small>‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏à‡∏∞‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏û‡∏£‡∏µ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</small>
                                            </td>
                                        </tr>
                                    ` : ordersData.map(order => `
                                        <tr class="border-b border-gray-700">
                                            <td class="py-3 px-4">#${order.id}</td>
                                            <td class="py-3 px-4">${order.customerName}</td>
                                            <td class="py-3 px-4">${order.product} (${order.size}) x${order.quantity}</td>
                                            <td class="py-3 px-4">‡∏ø${order.total.toLocaleString()}</td>
                                            <td class="py-3 px-4"><span class="${getStatusColor(order.status)} px-2 py-1 rounded text-xs">${order.status}</span></td>
                                            <td class="py-3 px-4">${order.date}</td>
                                            <td class="py-3 px-4">
                                                <button onclick="viewOrderDetails('${order.id}')" class="bg-blue-600 hover:bg-blue-700 px-2 py-1 rounded text-xs mr-1">‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</button>
                                                <button onclick="updateOrderStatus('${order.id}')" class="bg-green-600 hover:bg-green-700 px-2 py-1 rounded text-xs mr-1">‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</button>
                                                <button onclick="editOrder('${order.id}')" class="bg-orange-600 hover:bg-orange-700 px-2 py-1 rounded text-xs mr-1">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
                                                <button onclick="deleteOrder('${order.id}')" class="bg-red-600 hover:bg-red-700 px-2 py-1 rounded text-xs">‡∏•‡∏ö</button>
                                            </td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                    `
                },
                'generalSettings': {
                    title: 'üåê ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ',
                    content: `
                        <form class="space-y-6">
                            <div>
                                <label class="block text-sm font-medium mb-2">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå</label>
                                <input type="text" value="DY ESAN SHOP" class="w-full px-3 py-2 border border-gray-600 rounded-lg bg-gray-800 text-white">
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2">‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå</label>
                                <textarea rows="3" class="w-full px-3 py-2 border border-gray-600 rounded-lg bg-gray-800 text-white">‡∏û‡∏£‡∏µ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÄ‡∏™‡∏∑‡πâ‡∏≠ - ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏™‡∏π‡πà DY ESAN SHOP</textarea>
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2">‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</label>
                                <input type="email" value="contact@dyesan.com" class="w-full px-3 py-2 border border-gray-600 rounded-lg bg-gray-800 text-white">
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</label>
                                <input type="tel" value="0621759759" class="w-full px-3 py-2 border border-gray-600 rounded-lg bg-gray-800 text-white">
                            </div>
                            <button type="submit" class="bg-orange-600 hover:bg-orange-700 text-white px-6 py-2 rounded-lg">
                                ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
                            </button>
                        </form>
                    `
                },
                'paymentSlips': {
                    title: 'üìÑ ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏•‡∏¥‡∏õ‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô',
                    content: `
                        <div class="mb-6">
                            <div class="flex items-center justify-between mb-4">
                                <div class="flex items-center space-x-2">
                                    <span class="w-2 h-2 bg-blue-400 rounded-full animate-pulse"></span>
                                    <span class="text-blue-400 text-sm font-medium">‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö Google Drive</span>
                                </div>
                                <div class="text-xs text-gray-400">
                                    Folder ID: 147ix5n16Zx6cfJ9ColbvwnYjk-9xhvvE
                                </div>
                            </div>
                            
                            <div class="bg-blue-900/30 border border-blue-500 rounded-lg p-4 mb-6">
                                <div class="flex items-center mb-2">
                                    <span class="text-2xl mr-2">‚òÅÔ∏è</span>
                                    <span class="font-semibold text-blue-400">Google Drive Integration</span>
                                </div>
                                <p class="text-sm text-gray-300 mb-3">‡∏™‡∏•‡∏¥‡∏õ‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏õ‡∏¢‡∏±‡∏á Google Drive ‡πÇ‡∏î‡∏¢‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</p>
                                <a href="https://drive.google.com/drive/u/0/folders/147ix5n16Zx6cfJ9ColbvwnYjk-9xhvvE" 
                                   target="_blank" rel="noopener noreferrer" 
                                   class="inline-flex items-center bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm transition-colors">
                                    üìÅ ‡πÄ‡∏õ‡∏¥‡∏î Google Drive Folder
                                </a>
                            </div>
                        </div>
                        
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm">
                                <thead>
                                    <tr class="border-b border-gray-600">
                                        <th class="text-left py-3 px-4">‡πÑ‡∏ü‡∏•‡πå</th>
                                        <th class="text-left py-3 px-4">‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</th>
                                        <th class="text-left py-3 px-4">‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</th>
                                        <th class="text-left py-3 px-4">‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏ü‡∏•‡πå</th>
                                        <th class="text-left py-3 px-4">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î</th>
                                        <th class="text-left py-3 px-4">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                                        <th class="text-left py-3 px-4">‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                                    </tr>
                                </thead>
                                <tbody id="paymentSlipsTableBody">
                                    ${getPaymentSlipsTableContent()}
                                </tbody>
                            </table>
                        </div>
                    `
                },
                'salesReports': {
                    title: 'üí∞ ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢',
                    content: `
                        <div class="mb-4 text-center">
                            <div class="inline-flex items-center space-x-2 bg-green-900/30 border border-green-500 rounded-lg px-4 py-2">
                                <span class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></span>
                                <span class="text-green-400 text-sm font-medium">‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÅ‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏ó‡∏°‡πå</span>
                                <span class="text-gray-400 text-xs">|</span>
                                <span id="lastUpdate" class="text-gray-400 text-xs">‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: ${new Date().toLocaleTimeString('th-TH')}</span>
                            </div>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                            <div class="bg-green-900/50 border border-green-500 rounded-lg p-4 text-center">
                                <h4 class="text-lg font-bold text-green-400">‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</h4>
                                <p id="dailySales" class="text-2xl font-bold text-white">‡∏ø0</p>
                                <p class="text-xs text-green-300 mt-1">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${new Date().toLocaleDateString('th-TH')}</p>
                            </div>
                            <div class="bg-blue-900/50 border border-blue-500 rounded-lg p-4 text-center">
                                <h4 class="text-lg font-bold text-blue-400">‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</h4>
                                <p id="monthlySales" class="text-2xl font-bold text-white">‡∏ø0</p>
                                <p class="text-xs text-blue-300 mt-1">‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ${new Date().toLocaleDateString('th-TH', { month: 'long', year: 'numeric' })}</p>
                            </div>
                            <div class="bg-purple-900/50 border border-purple-500 rounded-lg p-4 text-center">
                                <h4 class="text-lg font-bold text-purple-400">‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏ß‡∏°</h4>
                                <p id="totalSales" class="text-2xl font-bold text-white">‡∏ø0</p>
                                <p class="text-xs text-purple-300 mt-1">‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡πâ‡∏≤‡∏ô</p>
                            </div>
                        </div>
                        <div class="bg-gray-800 rounded-lg p-4">
                            <div class="flex justify-between items-center mb-4">
                                <h4 class="text-lg font-bold">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ç‡∏≤‡∏¢‡∏î‡∏µ</h4>
                                <span class="text-xs text-gray-400">‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ó‡∏∏‡∏Å 5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</span>
                            </div>
                            <div class="space-y-2">
                                <div class="flex justify-between items-center">
                                    <span>NEW COLLECTION ESAN</span>
                                    <span id="productSold" class="font-bold text-yellow-400">0 ‡∏ä‡∏¥‡πâ‡∏ô</span>
                                </div>
                            </div>
                        </div>
                    `
                }
            };
            
            const section = sections[sectionType] || {
                title: '‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ',
                content: '<p class="text-center text-gray-400">‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏û‡∏±‡∏í‡∏ô‡∏≤ ‡∏à‡∏∞‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡πÄ‡∏£‡πá‡∏ß‡πÜ ‡∏ô‡∏µ‡πâ</p>'
            };
            
            titleElement.textContent = section.title;
            bodyElement.innerHTML = section.content;
            
            // Scroll to content area
            contentArea.scrollIntoView({ behavior: 'smooth' });
        }

        function closeAdminSection() {
            const contentArea = document.getElementById('adminSectionContent');
            contentArea.classList.add('hidden');
            contentArea.classList.remove('fade-in');
            
            // Stop real-time updates when closing admin section
            stopRealTimeUpdates();
        }

        // Sales tracking system
        let salesData = {
            daily: 0,
            monthly: 0,
            total: 0,
            productsSold: 0
        };

        // Orders tracking system
        let ordersData = [
            {
                id: 'ORD001',
                customerName: '‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡πÉ‡∏à‡∏î‡∏µ',
                phone: '081-234-5678',
                product: 'NEW COLLECTION ESAN',
                size: 'L',
                quantity: 2,
                total: 567,
                address: '123 ‡∏´‡∏°‡∏π‡πà 5 ‡∏ï‡∏≥‡∏ö‡∏•‡πÉ‡∏ô‡πÄ‡∏°‡∏∑‡∏≠‡∏á ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡πÄ‡∏°‡∏∑‡∏≠‡∏á ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏Ç‡∏≠‡∏ô‡πÅ‡∏Å‡πà‡∏ô 40000',
                paymentSlip: 'https://drive.google.com/file/d/demo_slip_001/view',
                paymentSlipName: 'slip_payment_001.jpg',
                status: '‡∏£‡∏≠‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô',
                date: new Date().toLocaleDateString('th-TH'),
                timestamp: new Date().toISOString()
            }
        ];

        function updateSalesDisplay() {
            // Update sales display in admin panel
            const dailyElement = document.getElementById('dailySales');
            const monthlyElement = document.getElementById('monthlySales');
            const totalElement = document.getElementById('totalSales');
            const productElement = document.getElementById('productSold');
            const lastUpdateElement = document.getElementById('lastUpdate');
            
            if (dailyElement) dailyElement.textContent = `‡∏ø${salesData.daily.toLocaleString()}`;
            if (monthlyElement) monthlyElement.textContent = `‡∏ø${salesData.monthly.toLocaleString()}`;
            if (totalElement) totalElement.textContent = `‡∏ø${salesData.total.toLocaleString()}`;
            if (productElement) productElement.textContent = `${salesData.productsSold} ‡∏ä‡∏¥‡πâ‡∏ô`;
            
            // Update last update time
            if (lastUpdateElement) {
                lastUpdateElement.textContent = `‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: ${new Date().toLocaleTimeString('th-TH')}`;
            }
            
            // Add animation effect when updating
            [dailyElement, monthlyElement, totalElement, productElement].forEach(element => {
                if (element) {
                    element.style.transform = 'scale(1.1)';
                    element.style.transition = 'transform 0.3s ease';
                    element.style.color = '#10b981'; // Green flash
                    setTimeout(() => {
                        element.style.transform = 'scale(1)';
                        element.style.color = ''; // Reset to original color
                    }, 300);
                }
            });
        }

        function calculateSalesFromOrders() {
            // Reset sales data
            salesData = {
                daily: 0,
                monthly: 0,
                total: 0,
                productsSold: 0
            };
            
            const today = new Date().toLocaleDateString('th-TH');
            const currentMonth = new Date().getMonth();
            const currentYear = new Date().getFullYear();
            
            // Calculate from all orders
            ordersData.forEach(order => {
                const orderDate = new Date(order.timestamp);
                const orderMonth = orderDate.getMonth();
                const orderYear = orderDate.getFullYear();
                
                // Add to total sales
                salesData.total += order.total;
                salesData.productsSold += order.quantity;
                
                // Add to monthly sales if same month and year
                if (orderMonth === currentMonth && orderYear === currentYear) {
                    salesData.monthly += order.total;
                }
                
                // Add to daily sales if same date
                if (order.date === today) {
                    salesData.daily += order.total;
                }
            });
            
            // Save to localStorage
            localStorage.setItem('dyesanSalesData', JSON.stringify(salesData));
            
            // Update display
            updateSalesDisplay();
        }

        function addOrder(orderData) {
            // Generate order ID
            const orderId = `ORD${String(ordersData.length + 1).padStart(3, '0')}`;
            
            const newOrder = {
                id: orderId,
                customerName: orderData.customerName,
                phone: orderData.phone,
                product: orderData.product,
                size: orderData.size,
                quantity: orderData.quantity,
                total: orderData.total,
                address: orderData.address,
                paymentSlip: orderData.paymentSlip || null,
                paymentSlipName: orderData.paymentSlipName || null,
                status: '‡∏£‡∏≠‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô',
                date: new Date().toLocaleDateString('th-TH'),
                timestamp: new Date().toISOString()
            };
            
            ordersData.push(newOrder);
            
            // Save to localStorage
            localStorage.setItem('dyesanOrdersData', JSON.stringify(ordersData));
            
            // Recalculate sales data from all orders
            calculateSalesFromOrders();
        }

        function updateOrdersList() {
            // This will be called when showing orders list in admin panel
            const ordersTableBody = document.querySelector('#ordersTableBody');
            if (ordersTableBody && ordersData.length > 0) {
                ordersTableBody.innerHTML = ordersData.map(order => `
                    <tr class="border-b border-gray-700">
                        <td class="py-3 px-4">#${order.id}</td>
                        <td class="py-3 px-4">${order.customerName}</td>
                        <td class="py-3 px-4">${order.product} (${order.size}) x${order.quantity}</td>
                        <td class="py-3 px-4">‡∏ø${order.total.toLocaleString()}</td>
                        <td class="py-3 px-4"><span class="${getStatusColor(order.status)} px-2 py-1 rounded text-xs">${order.status}</span></td>
                        <td class="py-3 px-4">${order.date}</td>
                        <td class="py-3 px-4">
                            <button onclick="viewOrderDetails('${order.id}')" class="bg-blue-600 hover:bg-blue-700 px-2 py-1 rounded text-xs mr-1">‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</button>
                            <button onclick="updateOrderStatus('${order.id}')" class="bg-green-600 hover:bg-green-700 px-2 py-1 rounded text-xs mr-1">‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</button>
                            <button onclick="editOrder('${order.id}')" class="bg-orange-600 hover:bg-orange-700 px-2 py-1 rounded text-xs mr-1">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
                            <button onclick="deleteOrder('${order.id}')" class="bg-red-600 hover:bg-red-700 px-2 py-1 rounded text-xs">‡∏•‡∏ö</button>
                        </td>
                    </tr>
                `).join('');
            }
        }

        // Load saved orders data on page load
        function loadOrdersData() {
            const saved = localStorage.getItem('dyesanOrdersData');
            if (saved) {
                ordersData = JSON.parse(saved);
            }
            // Always recalculate sales from orders to ensure data consistency
            calculateSalesFromOrders();
        }

        // Order management functions
        function viewOrderDetails(orderId) {
            const order = ordersData.find(o => o.id === orderId);
            if (!order) return;
            
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 p-4';
            modal.innerHTML = `
                <div class="bg-gray-900 border border-gray-700 rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto p-6 fade-in">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-2xl font-bold text-white">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå #${order.id}</h3>
                        <button onclick="this.closest('.fixed').remove()" class="text-gray-400 hover:text-white text-2xl">&times;</button>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <h4 class="text-lg font-bold text-blue-400 mb-4">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</h4>
                            <div class="space-y-2 text-sm">
                                <div><span class="font-semibold">‡∏ä‡∏∑‡πà‡∏≠:</span> ${order.customerName}</div>
                                <div><span class="font-semibold">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£:</span> ${order.phone}</div>
                                <div><span class="font-semibold">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà:</span><br>${order.address}</div>
                            </div>
                        </div>
                        
                        <div>
                            <h4 class="text-lg font-bold text-green-400 mb-4">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h4>
                            <div class="space-y-2 text-sm">
                                <div><span class="font-semibold">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤:</span> ${order.product}</div>
                                <div><span class="font-semibold">‡πÑ‡∏ã‡∏™‡πå:</span> ${order.size}</div>
                                <div><span class="font-semibold">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô:</span> ${order.quantity} ‡∏ä‡∏¥‡πâ‡∏ô</div>
                                <div><span class="font-semibold">‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°:</span> <span class="text-yellow-400 font-bold">‡∏ø${order.total.toLocaleString()}</span></div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Payment Slip Section -->
                    <div class="mt-6">
                        <h4 class="text-lg font-bold text-purple-400 mb-4">üí≥ ‡∏™‡∏•‡∏¥‡∏õ‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</h4>
                        <div class="bg-gray-800 border border-gray-600 rounded-lg p-4">
                            ${order.paymentSlip ? `
                                <div class="text-center">
                                    <div class="mb-3">
                                        <div class="w-full max-w-sm mx-auto bg-gray-700 border border-gray-600 rounded-lg p-4">
                                            ${order.paymentSlipData ? `
                                                <div class="mb-3">
                                                    <img src="${order.paymentSlipData}" alt="‡∏™‡∏•‡∏¥‡∏õ‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô" 
                                                         class="w-full max-w-xs mx-auto rounded-lg border border-gray-500"
                                                         style="max-height: 300px; object-fit: contain;">
                                                </div>
                                            ` : `
                                                <div class="text-4xl mb-2">üìÑ</div>
                                            `}
                                            <p class="text-white font-semibold mb-1">‡∏™‡∏•‡∏¥‡∏õ‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</p>
                                            <p class="text-gray-300 text-sm mb-3">${order.paymentSlipName || 'payment_slip.jpg'}</p>
                                            <div class="space-y-2">
                                                ${order.paymentSlipData ? `
                                                    <button onclick="viewFullSlip('${order.paymentSlipData}', '${order.paymentSlipName}')" 
                                                            class="inline-flex items-center bg-green-600 hover:bg-green-700 text-white px-3 py-2 rounded-lg text-sm transition-colors mr-2">
                                                        üîç ‡∏î‡∏π‡∏™‡∏•‡∏¥‡∏õ‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏ï‡πá‡∏°
                                                    </button>
                                                ` : ''}
                                                <a href="${order.paymentSlip}" target="_blank" rel="noopener noreferrer" 
                                                   class="inline-flex items-center bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 rounded-lg text-sm transition-colors">
                                                    üìÅ ‡∏î‡∏π‡πÉ‡∏ô Google Drive
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                    <p class="text-xs text-gray-400">‡∏™‡∏•‡∏¥‡∏õ‡∏ñ‡∏π‡∏Å‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏•‡πâ‡∏ß</p>
                                </div>
                            ` : `
                                <div class="text-center text-gray-400 py-8">
                                    <div class="text-4xl mb-2">üìÑ</div>
                                    <p>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏•‡∏¥‡∏õ‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</p>
                                    <p class="text-xs">‡∏™‡∏•‡∏¥‡∏õ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏õ‡∏¢‡∏±‡∏á Google Drive ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</p>
                                </div>
                            `}
                        </div>
                    </div>
                    
                    <div class="mt-6 p-4 bg-gray-800 rounded-lg">
                        <div class="flex justify-between items-center">
                            <div>
                                <span class="font-semibold">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</span> 
                                <span class="${getStatusColor(order.status)} px-2 py-1 rounded text-xs ml-2">${order.status}</span>
                            </div>
                            <div class="text-sm text-gray-400">
                                ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏±‡πà‡∏á: ${order.date}
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-6 flex justify-end space-x-3">
                        <button onclick="updateOrderStatus('${order.id}'); this.closest('.fixed').remove();" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg">
                            ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
                        </button>
                        <button onclick="editOrder('${order.id}'); this.closest('.fixed').remove();" class="bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-lg">
                            ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå
                        </button>
                        <button onclick="this.closest('.fixed').remove()" class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg">
                            ‡∏õ‡∏¥‡∏î
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }
        
        function updateOrderStatus(orderId) {
            const order = ordersData.find(o => o.id === orderId);
            if (!order) return;
            
            const statuses = ['‡∏£‡∏≠‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô', '‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß', '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ú‡∏•‡∏¥‡∏ï', '‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡πÅ‡∏•‡πâ‡∏ß', '‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å'];
            
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 p-4';
            modal.innerHTML = `
                <div class="bg-gray-900 border border-gray-700 rounded-xl max-w-md w-full p-6 fade-in">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xl font-bold text-white">‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</h3>
                        <button onclick="this.closest('.fixed').remove()" class="text-gray-400 hover:text-white text-2xl">&times;</button>
                    </div>
                    
                    <div class="mb-4">
                        <p class="text-gray-300 mb-2">‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå: <span class="font-bold">#${order.id}</span></p>
                        <p class="text-gray-300 mb-4">‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤: <span class="font-bold">${order.customerName}</span></p>
                        <p class="text-gray-300 mb-4">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô: <span class="${getStatusColor(order.status)} px-2 py-1 rounded text-xs">${order.status}</span></p>
                    </div>
                    
                    <form onsubmit="saveOrderStatus(event, '${orderId}')">
                        <div class="mb-6">
                            <label class="block text-sm font-medium text-gray-300 mb-2">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÉ‡∏´‡∏°‡πà *</label>
                            <select name="newStatus" required class="w-full px-3 py-2 border border-gray-600 rounded-lg bg-gray-800 text-white focus:ring-2 focus:ring-green-500">
                                ${statuses.map(status => `
                                    <option value="${status}" ${status === order.status ? 'selected' : ''}>${status}</option>
                                `).join('')}
                            </select>
                        </div>
                        
                        <div class="flex justify-end space-x-3">
                            <button type="button" onclick="this.closest('.fixed').remove()" class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg">
                                ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                            </button>
                            <button type="submit" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg">
                                ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
                            </button>
                        </div>
                    </form>
                </div>
            `;
            document.body.appendChild(modal);
        }
        
        function saveOrderStatus(event, orderId) {
            event.preventDefault();
            const newStatus = event.target.newStatus.value;
            
            // Update order status
            const orderIndex = ordersData.findIndex(o => o.id === orderId);
            if (orderIndex !== -1) {
                ordersData[orderIndex].status = newStatus;
                
                // Save to localStorage
                localStorage.setItem('dyesanOrdersData', JSON.stringify(ordersData));
                
                // Refresh orders list if currently showing
                if (document.getElementById('ordersTableBody')) {
                    showAdminSection('ordersList');
                }
                
                // Show success message
                const modal = event.target.closest('.fixed');
                modal.innerHTML = `
                    <div class="bg-gray-900 border border-gray-700 rounded-xl max-w-md w-full p-6 text-center fade-in">
                        <div class="w-16 h-16 bg-green-900/50 rounded-full flex items-center justify-center mx-auto mb-4">
                            <span class="text-3xl">‚úÖ</span>
                        </div>
                        <h3 class="text-xl font-bold text-white mb-4">‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</h3>
                        <p class="text-gray-300 mb-6">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå #${orderId} ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÄ‡∏õ‡πá‡∏ô "${newStatus}" ‡πÅ‡∏•‡πâ‡∏ß</p>
                        <button onclick="this.closest('.fixed').remove()" class="bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg">
                            ‡∏õ‡∏¥‡∏î
                        </button>
                    </div>
                `;
            }
        }
        
        function editOrder(orderId) {
            const order = ordersData.find(o => o.id === orderId);
            if (!order) return;
            
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 p-4';
            modal.innerHTML = `
                <div class="bg-gray-900 border border-gray-700 rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto p-6 fade-in">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xl font-bold text-white">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå #${order.id}</h3>
                        <button onclick="this.closest('.fixed').remove()" class="text-gray-400 hover:text-white text-2xl">&times;</button>
                    </div>
                    
                    <form onsubmit="saveOrderEdit(event, '${orderId}')">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-2">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• *</label>
                                <input type="text" name="customerName" value="${order.customerName}" required class="w-full px-3 py-2 border border-gray-600 rounded-lg bg-gray-800 text-white focus:ring-2 focus:ring-orange-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-2">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå *</label>
                                <input type="tel" name="phone" value="${order.phone}" required class="w-full px-3 py-2 border border-gray-600 rounded-lg bg-gray-800 text-white focus:ring-2 focus:ring-orange-500">
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-2">‡πÑ‡∏ã‡∏™‡πå *</label>
                                <select name="size" required class="w-full px-3 py-2 border border-gray-600 rounded-lg bg-gray-800 text-white focus:ring-2 focus:ring-orange-500" onchange="updateEditOrderPrice()">
                                    <option value="S" ${order.size === 'S' ? 'selected' : ''}>S</option>
                                    <option value="M" ${order.size === 'M' ? 'selected' : ''}>M</option>
                                    <option value="L" ${order.size === 'L' ? 'selected' : ''}>L</option>
                                    <option value="XL" ${order.size === 'XL' ? 'selected' : ''}>XL</option>
                                    <option value="XXL" ${order.size === 'XXL' ? 'selected' : ''}>XXL (+‡∏ø20)</option>
                                    <option value="3XL" ${order.size === '3XL' ? 'selected' : ''}>3XL (+‡∏ø40)</option>
                                    <option value="4XL" ${order.size === '4XL' ? 'selected' : ''}>4XL (+‡∏ø60)</option>
                                    <option value="5XL" ${order.size === '5XL' ? 'selected' : ''}>5XL (+‡∏ø60)</option>
                                    <option value="6XL" ${order.size === '6XL' ? 'selected' : ''}>6XL (+‡∏ø60)</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-2">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô *</label>
                                <input type="number" name="quantity" value="${order.quantity}" min="1" required class="w-full px-3 py-2 border border-gray-600 rounded-lg bg-gray-800 text-white focus:ring-2 focus:ring-orange-500" oninput="updateEditOrderPrice()">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-2">‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°</label>
                                <input type="text" id="editOrderTotal" value="‡∏ø${order.total.toLocaleString()}" readonly class="w-full px-3 py-2 border border-gray-600 rounded-lg bg-gray-700 text-gray-300">
                            </div>
                        </div>
                        
                        <div class="mb-6">
                            <label class="block text-sm font-medium text-gray-300 mb-2">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏±‡∏î‡∏™‡πà‡∏á *</label>
                            <textarea name="address" rows="3" required class="w-full px-3 py-2 border border-gray-600 rounded-lg bg-gray-800 text-white focus:ring-2 focus:ring-orange-500">${order.address}</textarea>
                        </div>
                        
                        <div class="flex justify-end space-x-3">
                            <button type="button" onclick="this.closest('.fixed').remove()" class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg">
                                ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                            </button>
                            <button type="submit" class="bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-lg">
                                ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
                            </button>
                        </div>
                    </form>
                </div>
            `;
            document.body.appendChild(modal);
        }
        
        function updateEditOrderPrice() {
            const form = event.target.closest('form');
            const size = form.querySelector('[name="size"]').value;
            const quantity = parseInt(form.querySelector('[name="quantity"]').value) || 1;
            
            let sizePrice = 0;
            if (size === 'XXL') sizePrice = 20;
            else if (size === '3XL') sizePrice = 40;
            else if (['4XL', '5XL', '6XL'].includes(size)) sizePrice = 60;
            
            const basePrice = 259;
            const shipping = 49;
            const itemTotal = (basePrice + sizePrice) * quantity;
            const total = itemTotal + shipping;
            
            form.querySelector('#editOrderTotal').value = `‡∏ø${total.toLocaleString()}`;
        }
        
        function saveOrderEdit(event, orderId) {
            event.preventDefault();
            const formData = new FormData(event.target);
            
            // Calculate new total
            const size = formData.get('size');
            const quantity = parseInt(formData.get('quantity'));
            
            let sizePrice = 0;
            if (size === 'XXL') sizePrice = 20;
            else if (size === '3XL') sizePrice = 40;
            else if (['4XL', '5XL', '6XL'].includes(size)) sizePrice = 60;
            
            const basePrice = 259;
            const shipping = 49;
            const itemTotal = (basePrice + sizePrice) * quantity;
            const total = itemTotal + shipping;
            
            // Update order
            const orderIndex = ordersData.findIndex(o => o.id === orderId);
            if (orderIndex !== -1) {
                ordersData[orderIndex] = {
                    ...ordersData[orderIndex],
                    customerName: formData.get('customerName'),
                    phone: formData.get('phone'),
                    size: formData.get('size'),
                    quantity: quantity,
                    total: total,
                    address: formData.get('address')
                };
                
                // Save to localStorage
                localStorage.setItem('dyesanOrdersData', JSON.stringify(ordersData));
                
                // Recalculate sales
                calculateSalesFromOrders();
                
                // Refresh orders list if currently showing
                if (document.getElementById('ordersTableBody')) {
                    showAdminSection('ordersList');
                }
                
                // Show success message
                const modal = event.target.closest('.fixed');
                modal.innerHTML = `
                    <div class="bg-gray-900 border border-gray-700 rounded-xl max-w-md w-full p-6 text-center fade-in">
                        <div class="w-16 h-16 bg-orange-900/50 rounded-full flex items-center justify-center mx-auto mb-4">
                            <span class="text-3xl">‚úÖ</span>
                        </div>
                        <h3 class="text-xl font-bold text-white mb-4">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</h3>
                        <p class="text-gray-300 mb-6">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå #${orderId} ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÅ‡∏•‡πâ‡∏ß</p>
                        <button onclick="this.closest('.fixed').remove()" class="bg-orange-600 hover:bg-orange-700 text-white px-6 py-2 rounded-lg">
                            ‡∏õ‡∏¥‡∏î
                        </button>
                    </div>
                `;
            }
        }
        
        function deleteOrder(orderId) {
            const order = ordersData.find(o => o.id === orderId);
            if (!order) return;
            
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 p-4';
            modal.innerHTML = `
                <div class="bg-gray-900 border border-red-500 rounded-xl max-w-md w-full p-6 fade-in">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xl font-bold text-red-400">‚ö†Ô∏è ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</h3>
                        <button onclick="this.closest('.fixed').remove()" class="text-gray-400 hover:text-white text-2xl">&times;</button>
                    </div>
                    
                    <div class="mb-6">
                        <p class="text-gray-300 mb-2">‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?</p>
                        <div class="bg-gray-800 p-4 rounded-lg mt-4">
                            <p class="text-white font-bold">‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå: #${order.id}</p>
                            <p class="text-gray-300">‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤: ${order.customerName}</p>
                            <p class="text-gray-300">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤: ${order.product} (${order.size}) x${order.quantity}</p>
                            <p class="text-yellow-400">‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°: ‡∏ø${order.total.toLocaleString()}</p>
                        </div>
                        <p class="text-red-400 text-sm mt-4">‚ö†Ô∏è ‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô‡πÑ‡∏î‡πâ</p>
                    </div>
                    
                    <div class="flex justify-end space-x-3">
                        <button onclick="this.closest('.fixed').remove()" class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg">
                            ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                        </button>
                        <button onclick="confirmDeleteOrder('${orderId}')" class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg">
                            ‡∏•‡∏ö‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }
        
        function confirmDeleteOrder(orderId) {
            // Remove order from array
            const orderIndex = ordersData.findIndex(o => o.id === orderId);
            if (orderIndex !== -1) {
                ordersData.splice(orderIndex, 1);
                
                // Save to localStorage
                localStorage.setItem('dyesanOrdersData', JSON.stringify(ordersData));
                
                // Recalculate sales
                calculateSalesFromOrders();
                
                // Refresh orders list if currently showing
                if (document.getElementById('ordersTableBody')) {
                    showAdminSection('ordersList');
                }
                
                // Show success message
                const modal = document.querySelector('.fixed');
                modal.innerHTML = `
                    <div class="bg-gray-900 border border-gray-700 rounded-xl max-w-md w-full p-6 text-center fade-in">
                        <div class="w-16 h-16 bg-red-900/50 rounded-full flex items-center justify-center mx-auto mb-4">
                            <span class="text-3xl">üóëÔ∏è</span>
                        </div>
                        <h3 class="text-xl font-bold text-white mb-4">‡∏•‡∏ö‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</h3>
                        <p class="text-gray-300 mb-6">‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå #${orderId} ‡πÑ‡∏î‡πâ‡∏ñ‡∏π‡∏Å‡∏•‡∏ö‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏•‡πâ‡∏ß</p>
                        <button onclick="this.closest('.fixed').remove()" class="bg-red-600 hover:bg-red-700 text-white px-6 py-2 rounded-lg">
                            ‡∏õ‡∏¥‡∏î
                        </button>
                    </div>
                `;
            }
        }

        function getStatusColor(status) {
            // This function will return appropriate color classes for order status
            const statusColors = {
                '‡∏£‡∏≠‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô': 'bg-yellow-600',
                '‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß': 'bg-blue-600', 
                '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ú‡∏•‡∏¥‡∏ï': 'bg-purple-600',
                '‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡πÅ‡∏•‡πâ‡∏ß': 'bg-indigo-600',
                '‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à': 'bg-green-600',
                '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å': 'bg-red-600'
            };
            return statusColors[status] || 'bg-gray-600';
        }

        // Function to view full slip image
        function viewFullSlip(imageData, fileName) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50 p-4';
            modal.innerHTML = `
                <div class="max-w-4xl w-full max-h-[90vh] overflow-auto bg-gray-900 rounded-xl p-4">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-bold text-white">‡∏™‡∏•‡∏¥‡∏õ‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô - ${fileName}</h3>
                        <button onclick="this.closest('.fixed').remove()" class="text-gray-400 hover:text-white text-2xl">&times;</button>
                    </div>
                    <div class="text-center">
                        <img src="${imageData}" alt="‡∏™‡∏•‡∏¥‡∏õ‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô" 
                             class="max-w-full max-h-[70vh] mx-auto rounded-lg border border-gray-600"
                             style="object-fit: contain;">
                    </div>
                    <div class="mt-4 text-center">
                        <button onclick="downloadSlip('${imageData}', '${fileName}')" 
                                class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg mr-2">
                            üíæ ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î
                        </button>
                        <button onclick="this.closest('.fixed').remove()" 
                                class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg">
                            ‡∏õ‡∏¥‡∏î
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }
        
        // Function to download slip image
        function downloadSlip(imageData, fileName) {
            const link = document.createElement('a');
            link.href = imageData;
            link.download = fileName || 'payment_slip.jpg';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // Payment slips management functions
        function getPaymentSlipsTableContent() {
            const uploadedFiles = JSON.parse(localStorage.getItem('uploadedSlips') || '[]');
            
            if (uploadedFiles.length === 0) {
                return `
                    <tr>
                        <td colspan="7" class="py-8 px-4 text-center text-gray-400">
                            ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏•‡∏¥‡∏õ‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö<br>
                            <small>‡∏™‡∏•‡∏¥‡∏õ‡∏à‡∏∞‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏•‡∏¥‡∏õ‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</small>
                        </td>
                    </tr>
                `;
            }
            
            return uploadedFiles.map((file, index) => {
                // Find matching order
                const matchingOrder = ordersData.find(order => 
                    order.paymentSlipName === file.fileName || 
                    order.paymentSlip === file.url
                );
                
                const fileSize = (file.fileSize / 1024).toFixed(1) + ' KB';
                const uploadDate = new Date(file.uploadTime).toLocaleDateString('th-TH');
                const uploadTime = new Date(file.uploadTime).toLocaleTimeString('th-TH');
                
                return `
                    <tr class="border-b border-gray-700">
                        <td class="py-3 px-4">
                            <div class="flex items-center space-x-2">
                                <span class="text-lg">üìÑ</span>
                                <div>
                                    <p class="font-semibold text-white text-sm">${file.fileName}</p>
                                    <p class="text-xs text-gray-400">${file.fileType}</p>
                                </div>
                            </div>
                        </td>
                        <td class="py-3 px-4">
                            ${matchingOrder ? `
                                <span class="font-semibold text-blue-400">#${matchingOrder.id}</span>
                            ` : `
                                <span class="text-gray-400 text-sm">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</span>
                            `}
                        </td>
                        <td class="py-3 px-4">
                            ${matchingOrder ? `
                                <div>
                                    <p class="font-semibold text-white text-sm">${matchingOrder.customerName}</p>
                                    <p class="text-xs text-gray-400">${matchingOrder.phone}</p>
                                </div>
                            ` : `
                                <span class="text-gray-400 text-sm">-</span>
                            `}
                        </td>
                        <td class="py-3 px-4">${fileSize}</td>
                        <td class="py-3 px-4">
                            <div>
                                <p class="text-sm">${uploadDate}</p>
                                <p class="text-xs text-gray-400">${uploadTime}</p>
                            </div>
                        </td>
                        <td class="py-3 px-4">
                            <span class="${file.status === 'uploaded_to_drive' ? 'bg-green-600' : 'bg-yellow-600'} px-2 py-1 rounded text-xs">
                                ${file.status === 'uploaded_to_drive' ? '‚úÖ ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏•‡πâ‡∏ß' : 'üíæ ‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•'}
                            </span>
                        </td>
                        <td class="py-3 px-4">
                            <div class="flex space-x-1">
                                <button onclick="viewPaymentSlip('${index}')" class="bg-blue-600 hover:bg-blue-700 px-2 py-1 rounded text-xs">‡∏î‡∏π</button>
                                <button onclick="downloadPaymentSlip('${index}')" class="bg-green-600 hover:bg-green-700 px-2 py-1 rounded text-xs">‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î</button>
                                <button onclick="deletePaymentSlip('${index}')" class="bg-red-600 hover:bg-red-700 px-2 py-1 rounded text-xs">‡∏•‡∏ö</button>
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');
        }
        
        function viewPaymentSlip(fileIndex) {
            const uploadedFiles = JSON.parse(localStorage.getItem('uploadedSlips') || '[]');
            const file = uploadedFiles[fileIndex];
            
            if (!file) return;
            
            // Find matching order
            const matchingOrder = ordersData.find(order => 
                order.paymentSlipName === file.fileName || 
                order.paymentSlip === file.url
            );
            
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50 p-4';
            modal.innerHTML = `
                <div class="max-w-4xl w-full max-h-[90vh] overflow-auto bg-gray-900 rounded-xl p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xl font-bold text-white">‡∏™‡∏•‡∏¥‡∏õ‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</h3>
                        <button onclick="this.closest('.fixed').remove()" class="text-gray-400 hover:text-white text-2xl">&times;</button>
                    </div>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- Slip Image -->
                        <div class="text-center">
                            <div class="bg-gray-800 border border-gray-600 rounded-lg p-4 mb-4">
                                ${file.dataUrl ? `
                                    <img src="${file.dataUrl}" alt="‡∏™‡∏•‡∏¥‡∏õ‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô" 
                                         class="max-w-full max-h-96 mx-auto rounded-lg border border-gray-500"
                                         style="object-fit: contain;">
                                ` : `
                                    <div class="text-4xl mb-2 text-gray-400">üìÑ</div>
                                    <p class="text-gray-400">‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏î‡πâ</p>
                                `}
                            </div>
                            <div class="space-x-2">
                                <button onclick="downloadPaymentSlip('${fileIndex}')" 
                                        class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg">
                                    üíæ ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î
                                </button>
                                <a href="${file.url}" target="_blank" rel="noopener noreferrer" 
                                   class="inline-block bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg">
                                    üìÅ ‡∏î‡∏π‡πÉ‡∏ô Google Drive
                                </a>
                            </div>
                        </div>
                        
                        <!-- File Info -->
                        <div>
                            <h4 class="text-lg font-bold text-blue-400 mb-4">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏ü‡∏•‡πå</h4>
                            <div class="space-y-3 text-sm">
                                <div class="bg-gray-800 p-3 rounded-lg">
                                    <span class="font-semibold text-gray-300">‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå:</span><br>
                                    <span class="text-white">${file.fileName}</span>
                                </div>
                                <div class="bg-gray-800 p-3 rounded-lg">
                                    <span class="font-semibold text-gray-300">‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏ü‡∏•‡πå:</span><br>
                                    <span class="text-white">${(file.fileSize / 1024).toFixed(1)} KB</span>
                                </div>
                                <div class="bg-gray-800 p-3 rounded-lg">
                                    <span class="font-semibold text-gray-300">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÑ‡∏ü‡∏•‡πå:</span><br>
                                    <span class="text-white">${file.fileType}</span>
                                </div>
                                <div class="bg-gray-800 p-3 rounded-lg">
                                    <span class="font-semibold text-gray-300">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î:</span><br>
                                    <span class="text-white">${new Date(file.uploadTime).toLocaleString('th-TH')}</span>
                                </div>
                                <div class="bg-gray-800 p-3 rounded-lg">
                                    <span class="font-semibold text-gray-300">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</span><br>
                                    <span class="${file.status === 'uploaded_to_drive' ? 'text-green-400' : 'text-yellow-400'}">
                                        ${file.status === 'uploaded_to_drive' ? '‚úÖ ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏õ Google Drive ‡πÅ‡∏•‡πâ‡∏ß' : 'üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö'}
                                    </span>
                                </div>
                            </div>
                            
                            ${matchingOrder ? `
                                <h4 class="text-lg font-bold text-green-400 mb-4 mt-6">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</h4>
                                <div class="space-y-3 text-sm">
                                    <div class="bg-gray-800 p-3 rounded-lg">
                                        <span class="font-semibold text-gray-300">‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå:</span><br>
                                        <span class="text-blue-400 font-bold">#${matchingOrder.id}</span>
                                    </div>
                                    <div class="bg-gray-800 p-3 rounded-lg">
                                        <span class="font-semibold text-gray-300">‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤:</span><br>
                                        <span class="text-white">${matchingOrder.customerName}</span><br>
                                        <span class="text-gray-400">${matchingOrder.phone}</span>
                                    </div>
                                    <div class="bg-gray-800 p-3 rounded-lg">
                                        <span class="font-semibold text-gray-300">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤:</span><br>
                                        <span class="text-white">${matchingOrder.product} (${matchingOrder.size}) x${matchingOrder.quantity}</span>
                                    </div>
                                    <div class="bg-gray-800 p-3 rounded-lg">
                                        <span class="font-semibold text-gray-300">‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°:</span><br>
                                        <span class="text-yellow-400 font-bold">‡∏ø${matchingOrder.total.toLocaleString()}</span>
                                    </div>
                                </div>
                            ` : `
                                <div class="mt-6 p-4 bg-yellow-900/30 border border-yellow-500 rounded-lg">
                                    <p class="text-yellow-400 text-sm">‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏¢‡∏á‡∏Å‡∏±‡∏ö‡∏™‡∏•‡∏¥‡∏õ‡∏ô‡∏µ‡πâ</p>
                                </div>
                            `}
                        </div>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }
        
        function downloadPaymentSlip(fileIndex) {
            const uploadedFiles = JSON.parse(localStorage.getItem('uploadedSlips') || '[]');
            const file = uploadedFiles[fileIndex];
            
            if (!file || !file.dataUrl) return;
            
            const link = document.createElement('a');
            link.href = file.dataUrl;
            link.download = file.fileName || 'payment_slip.jpg';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
        
        function deletePaymentSlip(fileIndex) {
            const uploadedFiles = JSON.parse(localStorage.getItem('uploadedSlips') || '[]');
            const file = uploadedFiles[fileIndex];
            
            if (!file) return;
            
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 p-4';
            modal.innerHTML = `
                <div class="bg-gray-900 border border-red-500 rounded-xl max-w-md w-full p-6 fade-in">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xl font-bold text-red-400">‚ö†Ô∏è ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏™‡∏•‡∏¥‡∏õ</h3>
                        <button onclick="this.closest('.fixed').remove()" class="text-gray-400 hover:text-white text-2xl">&times;</button>
                    </div>
                    
                    <div class="mb-6">
                        <p class="text-gray-300 mb-4">‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏™‡∏•‡∏¥‡∏õ‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?</p>
                        <div class="bg-gray-800 p-4 rounded-lg">
                            <p class="font-semibold text-white">${file.fileName}</p>
                            <p class="text-gray-400 text-sm">‡∏Ç‡∏ô‡∏≤‡∏î: ${(file.fileSize / 1024).toFixed(1)} KB</p>
                            <p class="text-gray-400 text-sm">‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î: ${new Date(file.uploadTime).toLocaleDateString('th-TH')}</p>
                        </div>
                        <p class="text-red-400 text-sm mt-4">‚ö†Ô∏è ‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏™‡∏•‡∏¥‡∏õ‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô‡πÑ‡∏î‡πâ</p>
                    </div>
                    
                    <div class="flex justify-end space-x-3">
                        <button onclick="this.closest('.fixed').remove()" class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg">
                            ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                        </button>
                        <button onclick="confirmDeletePaymentSlip('${fileIndex}')" class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg">
                            ‡∏•‡∏ö‡∏™‡∏•‡∏¥‡∏õ
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }
        
        function confirmDeletePaymentSlip(fileIndex) {
            const uploadedFiles = JSON.parse(localStorage.getItem('uploadedSlips') || '[]');
            
            // Remove file from array
            uploadedFiles.splice(fileIndex, 1);
            
            // Save back to localStorage
            localStorage.setItem('uploadedSlips', JSON.stringify(uploadedFiles));
            
            // Refresh payment slips list if currently showing
            if (document.getElementById('paymentSlipsTableBody')) {
                showAdminSection('paymentSlips');
            }
            
            // Show success message
            const modal = document.querySelector('.fixed');
            modal.innerHTML = `
                <div class="bg-gray-900 border border-gray-700 rounded-xl max-w-md w-full p-6 text-center fade-in">
                    <div class="w-16 h-16 bg-red-900/50 rounded-full flex items-center justify-center mx-auto mb-4">
                        <span class="text-3xl">üóëÔ∏è</span>
                    </div>
                    <h3 class="text-xl font-bold text-white mb-4">‡∏•‡∏ö‡∏™‡∏•‡∏¥‡∏õ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</h3>
                    <p class="text-gray-300 mb-6">‡∏™‡∏•‡∏¥‡∏õ‡πÑ‡∏î‡πâ‡∏ñ‡∏π‡∏Å‡∏•‡∏ö‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏•‡πâ‡∏ß</p>
                    <button onclick="this.closest('.fixed').remove()" class="bg-red-600 hover:bg-red-700 text-white px-6 py-2 rounded-lg">
                        ‡∏õ‡∏¥‡∏î
                    </button>
                </div>
            `;
        }

        // Initialize page on load
        document.addEventListener('DOMContentLoaded', function() {
            showPage('home');
            loadOrdersData();
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'995e0b00b52826c1',t:'MTc2MTY5MjM2MC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
